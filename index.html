<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>金馬鴻運聚福堂 - 崇正寶宮靈籤</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel CDN -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700;900&display=swap');
        
        :root {
            --wood-base: #a52a2a;
            --wood-dark: #5d1a1a;
            --gold-glow: #fbbf24;
        }

        body {
            font-family: 'Noto Serif TC', serif;
            margin: 0;
            padding: 0;
            background-color: #2d0a0a;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* 門釘樣式 */
        .gate-stud {
            width: clamp(10px, 2.5vw, 14px);
            height: clamp(10px, 2.5vw, 14px);
            background: radial-gradient(circle at 35% 35%, #fbbf24, #b45309);
            border-radius: 50%;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.7);
        }

        /* 3D 門型容器 */
        .gate-perspective {
            perspective: 2000px;
            overflow: hidden;
        }

        /* 旋轉開門動畫 */
        @keyframes swing-left {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(-115deg); }
        }
        @keyframes swing-right {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(115deg); }
        }
        
        .animate-swing-left { 
            transform-origin: left;
            animation: swing-left 2.8s cubic-bezier(0.4, 0, 0.2, 1) forwards; 
            animation-delay: 0.2s;
        }
        .animate-swing-right { 
            transform-origin: right;
            animation: swing-right 2.8s cubic-bezier(0.4, 0, 0.2, 1) forwards; 
            animation-delay: 0.2s;
        }
        
        /* 隱藏捲軸 */
        ::-webkit-scrollbar { display: none; }

        .paper-texture {
            background-image: url("https://www.transparenttextures.com/patterns/paper-fibers.png");
        }

        .wood-texture {
            background-color: var(--wood-base);
            background-image: repeating-linear-gradient(
                90deg,
                rgba(0,0,0,0.2) 0px,
                rgba(0,0,0,0.2) 2px,
                transparent 2px,
                transparent 50px,
                rgba(255,255,255,0.05) 50px,
                rgba(255,255,255,0.05) 52px
            );
            box-shadow: inset 0 0 120px rgba(0,0,0,0.7);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const Icons = {
            ChevronLeft: () => (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>
            ),
            Sparkles: ({ className }) => (
                <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3 1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>
            ),
            RefreshCw: () => (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>
            ),
            Camera: () => (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>
            ),
            MountainLogo: ({ className }) => (
                <img src="白陽山LOGO.jpg" alt="白陽山LOGO" className={className} style={{ objectFit: 'contain' }} />
            ),
            PhotoKnocker: ({ side }) => (
                <div className={`relative flex items-center justify-center ${side === 'left' ? 'mr-[-40px]' : 'ml-[-40px]'} z-20`}>
                    <div className="w-20 h-20 md:w-24 md:h-24 rounded-full bg-red-700 border-4 border-amber-500 shadow-[0_0_20px_rgba(0,0,0,0.6)] flex items-center justify-center relative">
                        <div className="w-16 h-16 md:w-20 md:h-20 rounded-full border border-amber-600/50 shadow-inner" />
                        <div className="absolute inset-2 rounded-full bg-gradient-to-br from-white/10 to-transparent pointer-events-none" />
                    </div>
                </div>
            )
        };

        const fortuneData = {
            "1": ["欲成精金美玉品", "須向烈火焠煉真", "思立驚天動地業", "須懷慎終如始心"],
            "2": ["渡海浮囊一針差", "千里堤堰一蟻沙", "念頭雖微物縱恣", "高聳德業一夕塌"],
            "3": ["閒時常省言行合", "忙處為事自少過", "靜時常守元神住", "動中起念必不脫"],
            "4": ["世態炎涼無倚偏", "世味濃淡無欣厭", "如水隨方而就圓", "融通得體自在安"],
            "5": ["昨日之非莫留遺", "塵情必累自性地", "今日之是莫執拘", "真性反轉慾念及"],
            "6": ["建功立德踏實地", "若慕聲望業終息", "修善培福立根基", "若計功勞果終虛"],
            "7": ["由外境物而得者", "有得有失常有落", "不若向內求真實", "自得自獲更廣闊"],
            "8": ["不忍之念愛物芽", "芽發枝長蔭群娃", "喜捨之心福田根", "根深蒂固美果佳"],
            "9": ["心似明珠物慾蔽", "如混泥沙滌猶易", "塵情識神若黏附", "如飾銀黃滌何去"],
            "10": ["垢病易察無憂治", "潔病難察恐無治", "事障易視無愁滯", "理障難視恐留滯"],
            "11": ["生來死去有歸無", "何人視透向道途", "因緣果報早已註", "積功培德勤力篤"],
            "12": ["九死一生出鬼關", "猛然覺醒回頭岸", "", ""],
            "13": ["轉又轉唷打陀螺", "何時停歇何時落", "萬般皆有因與果", "智慧之者早跳脫"],
            "14": ["操守須有真主宰", "遇事穩固不搖擺", "", ""],
            "15": ["因人啟覺而悟者", "有悟尚還有迷惑", "不若自心定靜省", "自覺自悟力行作"],
            "16": ["化得家中嫌隙雪", "手足同心力和協", "父慈子孝萬事興", "攜手向道歡喜悅"],
            "17": ["一念謬差毀前善", "半世功名百世冤", "謹言慎行戰兢前", "參透修道是本源"],
            "18": ["夭壽窮通各不一", "各人運途各人趨", "轉運改命由自己", "修道為本早上梯"],
            "19": ["清風明月翠松竹", "粗衣淡飯自在處", "虛其心而實其腹", "不憂利祿與榮辱"],
            "20": ["皮囊有盡氣數限", "明了之者緊向前", "名利浮雲終消散", "放下無拘自在安"],
            "21": ["浮華聲色蔽心目", "主人反受僕役奴", "懸崖邊緣競相逐", "慧眼速睜脫束縛"],
            "22": ["聲色障礙成聾啞", "昏昏暗暗如何察", "一盞智燈破痴傻", "循序漸進聖域達"],
            "23": ["數粒充腸亦果腹", "名利充腸何時足", "墨水充腸言暢舒", "道義充腸自如如"],
            "24": ["求佛拜佛口念佛", "真佛在前識不破", "非是眼前障礙多", "十惡八邪將心鎖"],
            "25": ["說三道四爛腐舌", "滿腹人非養毒蛇", "傷得人家亦害己", "不若內修緘口舌"],
            "26": ["行善莫謂身無錢", "一旦病來費萬千", "早行功來早保命", "莫等命休早知前"],
            "27": ["閻王老無情客", "無須邀至寒舍", "縱不願亦不可", "萬貫財終必捨"],
            "28": ["黃泉路冷清清", "任至親亦獨行", "若如此何計較", "早修道登理程"],
            "29": ["點開生死匣", "不被閻君轄", "玄祖喜樂佳", "修辦腳步跨"],
            "30": ["百年好佳光", "切莫渺茫往", "如此壽亦夭", "未死已先葬"],
            "31": ["一炬火燒盡", "萬有成灰燼", "形象皆成空", "修道當殷勤"],
            "32": ["賊人偷身外物", "偷不去性佛祖", "物不在無礙阻", "樂歡喜滌雜污"],
            "33": ["洗淨世間之塵埃", "焰火寒冰心無礙", "平息眼光之鄙吝", "霽月光風時常在"],
            "34": ["閒暇之時惕惰氣", "收攝心猿暢天機", "騰達之時惕傲氣", "收斂心神禍遠避"],
            "35": ["酒色財氣四條路", "散亂本心深淵赴", "斷了智慧稟氣固", "何時跳脫何出苦"],
            "36": ["上天無親德為輔", "進德修業必不孤", "事事反求於諸己", "根基穩立功德儲"],
            "37": ["心外求佛何處得", "尋尋覓覓愈挫折", "回頭靈山修真我", "除污復顯自性佛"],
            "38": ["走馬看花一溜煙", "禪機妙訓誰參研", "前世今生早明瞭", "快向道途保身前"],
            "39": ["顛黑倒白世態遷", "誰是誰非難論全", "只求問心而無愧", "精進德業了冤愆"],
            "40": ["啞吃黃蓮苦難言", "劇本已定如何變", "家家有本難念經", "惟有修道是根源"],
            "41": ["一念之差千里外", "回頭已是百年身", "", ""]
        };

        const App = () => {
            const [page, setPage] = useState('home');
            const [lotNumber, setLotNumber] = useState('');
            const [currentDate, setCurrentDate] = useState('');
            const audioRef = useRef(null);

            useEffect(() => {
                const today = new Date();
                setCurrentDate(`${today.getFullYear()}年${today.getMonth() + 1}月${today.getDate()}日`);
                audioRef.current = new Audio('https://assets.mixkit.co/active_storage/sfx/2180/2180-preview.mp3'); 
            }, []);

            const handleStart = () => {
                const num = parseInt(lotNumber);
                if (!lotNumber || isNaN(num)) return;
                setPage('door');
                if (audioRef.current) {
                    audioRef.current.currentTime = 0;
                    audioRef.current.play().catch(() => {});
                }
                setTimeout(() => setPage('result'), 2800);
            };

            const getPoem = (num) => {
                const key = parseInt(num).toString();
                return fortuneData[key] || ["誠心祈求靈感應", "福星高照事皆興", "所求之事皆如意", "心誠則靈顯神明"];
            };

            const GateHalf = ({ side }) => {
                const studs = Array(6).fill(0);
                return (
                    <div className={`w-1/2 h-full wood-texture border-y-8 border-black relative flex items-center shadow-[inset_0_0_80px_rgba(0,0,0,0.8)] ${side === 'left' ? 'animate-swing-left justify-end border-r-2 border-r-black/50' : 'animate-swing-right justify-start border-l-2 border-l-black/50'}`}>
                        <div className="absolute inset-y-0 w-full bg-gradient-to-r from-black/20 via-transparent to-black/20 pointer-events-none" />
                        <div className={`absolute inset-0 flex items-center ${side === 'left' ? 'justify-start pl-8 md:pl-16' : 'justify-end pr-8 md:pr-16'}`}>
                            <div className="grid grid-cols-2 grid-rows-3 gap-x-6 gap-y-12 md:gap-x-12 md:gap-y-20 opacity-90">
                                {studs.map((_, i) => <div key={i} className="gate-stud" />)}
                            </div>
                        </div>
                        <Icons.PhotoKnocker side={side} />
                    </div>
                );
            };

            if (page === 'home') {
                return (
                    <div className="min-h-screen bg-[#2d0a0a] text-stone-200 flex flex-col items-center justify-center p-6 relative overflow-hidden">
                        <div className="text-center z-10 w-full max-w-lg px-4">
                            <div className="mb-8 md:mb-12">
                                <h2 className="text-amber-500 text-xs md:text-sm tracking-[0.4em] font-medium mb-3 uppercase">Gold Horse Fortune</h2>
                                <h1 className="text-5xl md:text-8xl font-black text-white mb-2 drop-shadow-2xl tracking-tighter">金馬鴻運</h1>
                                <h2 className="text-4xl md:text-5xl font-bold text-amber-500 tracking-widest">聚福堂</h2>
                            </div>
                            <div className="relative mt-8 group">
                                <div className="absolute -top-4 left-1/2 -translate-x-1/2 bg-[#5d1a1a] border border-amber-600/50 px-5 py-1 rounded-full z-20 shadow-lg">
                                    <span className="text-amber-200 text-xs md:text-sm tracking-widest whitespace-nowrap font-medium">誠心祈求 - 靈籤指引</span>
                                </div>
                                <div className="bg-gradient-to-b from-amber-900/40 to-black/60 p-5 md:p-8 rounded-2xl border border-amber-500/30 shadow-[0_0_50px_rgba(251,191,36,0.15)] backdrop-blur-md">
                                    <div className="bg-black/50 border border-amber-500/50 rounded-lg p-3 mb-6">
                                        <input
                                            type="number"
                                            inputMode="numeric"
                                            value={lotNumber}
                                            onChange={(e) => setLotNumber(e.target.value)}
                                            placeholder="籤號 (1-41)"
                                            className="w-full bg-transparent text-center text-3xl md:text-5xl text-stone-300 focus:outline-none py-2"
                                        />
                                    </div>
                                    <button onClick={handleStart} className="w-full bg-gradient-to-b from-[#e68a00] to-[#b35900] text-white py-4 rounded-xl shadow-xl flex items-center justify-center gap-3 active:scale-95 transition-all">
                                        <Icons.Sparkles className="text-amber-100" />
                                        <span className="text-lg md:text-xl font-bold tracking-[0.2em]">開啟鴻運</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (page === 'door') {
                return (
                    <div className="fixed inset-0 bg-black flex z-[100] gate-perspective">
                        <GateHalf side="left" />
                        <GateHalf side="right" />
                        <div className="absolute inset-0 bg-[#f4f3ed] flex items-center justify-center -z-10">
                            <div className="text-amber-600 text-2xl md:text-3xl font-bold animate-pulse tracking-widest">福氣臨門...</div>
                        </div>
                    </div>
                );
            }

            if (page === 'result') {
                const poem = getPoem(lotNumber);
                return (
                    <div className="min-h-screen bg-[#f4f3ed] p-4 flex flex-col items-center">
                        <div className="w-full max-w-lg mb-4">
                            <button onClick={() => setPage('home')} className="flex items-center text-red-900 text-sm font-bold p-2 active:opacity-50 transition-opacity">
                                <Icons.ChevronLeft /> 重返聚福堂
                            </button>
                            <div className="h-[1px] bg-stone-300 w-full" />
                        </div>
                        <div className="w-full max-w-lg bg-white rounded-xl shadow-xl mb-6 flex flex-col overflow-hidden">
                            <div className="h-14 md:h-16 bg-[#a52a2a] relative flex items-center px-6 shrink-0">
                                <Icons.Sparkles className="text-white/20" />
                            </div>
                            
                            <div className="px-6 md:px-10 py-8 flex flex-col items-center">
                                <div className="w-24 h-24 md:w-28 md:h-28 bg-[#fbefcc] rounded-full border-4 border-[#e9d5a1] shadow-md flex items-center justify-center mb-8 mt-2 shrink-0 relative z-10 p-2 overflow-hidden">
                                    <Icons.MountainLogo className="w-full h-full" />
                                </div>
                                
                                <h2 className="text-2xl md:text-3xl font-bold text-stone-800 mb-6 text-center tracking-tight">靈籤第 {parseInt(lotNumber)} 號 - 心誠則靈</h2>
                                
                                <div className="w-full bg-[#fdfaf2] border-l-4 border-amber-800 p-6 mb-8 text-stone-800 text-lg md:text-xl leading-relaxed rounded-r-lg shadow-sm font-bold text-center">
                                    {poem.map((line, i) => (
                                        <div key={i} className="mb-1">{line}</div>
                                    ))}
                                </div>
                                
                                <div className="w-full">
                                    <h3 className="text-red-900 font-bold mb-4 border-b border-stone-200 pb-2 tracking-widest text-xs uppercase">靈籤指引</h3>
                                    <p className="text-stone-600 text-sm md:text-base leading-relaxed text-center">
                                        吉人自有天相，誠心祈求，必有迴響。此籤詩提示您修身立德為本，萬事方能順遂平安。
                                    </p>
                                </div>
                            </div>
                        </div>
                        <button onClick={() => setPage('card')} className="w-full max-w-lg bg-gradient-to-b from-[#d97706] to-[#b45309] text-white py-4 rounded-xl shadow-lg flex items-center justify-center gap-2 font-bold text-lg active:scale-95 transition-all mt-auto mb-4">
                            <Icons.Camera /> 領取福卡
                        </button>
                    </div>
                );
            }

            if (page === 'card') {
                const poem = getPoem(lotNumber);
                return (
                    <div className="min-h-screen bg-black flex flex-col items-center justify-center p-4 md:p-6">
                        <div className="relative w-full max-w-[300px] md:max-w-[320px] rounded-[24px] md:rounded-[32px] overflow-hidden shadow-[0_0_50px_rgba(180,83,9,0.35)] border-2 border-amber-600/30 flex flex-col">
                            <div className="bg-gradient-to-b from-[#d32f2f] to-[#8b0000] p-6 pt-4 pb-10 flex flex-col items-center relative">
                                <span className="text-[9px] text-amber-400/80 tracking-[0.2em] font-bold mb-4 uppercase">Fortune Card</span>
                                <div className="w-14 h-14 rounded-full border border-amber-400/30 flex items-center justify-center mb-6 bg-white/5 shadow-inner p-2 overflow-hidden">
                                    <Icons.MountainLogo className="w-full h-full" />
                                </div>
                                
                                {/* 修改福卡標題：文字水平置中 */}
                                <div className="w-full text-center space-y-1 px-4">
                                    <h2 className="text-2xl md:text-3xl font-black text-white tracking-[0.1em]">一馬當先新開運</h2>
                                    <h2 className="text-2xl md:text-3xl font-black text-amber-400 tracking-[0.1em]">萬事順風到終局</h2>
                                </div>
                            </div>
                            <div className="bg-[#fcfaf2] p-6 pb-8 flex flex-col items-center relative text-stone-800 paper-texture">
                                <div className="text-[10px] text-red-800 font-bold mb-6 tracking-[0.2em] opacity-80 uppercase text-center">
                                    — 崇正寶宮 靈籤指引 —
                                </div>
                                
                                <div className="bg-[#f5f3e9]/80 rounded-xl p-6 text-center shadow-inner border border-stone-200/50 min-h-[140px] flex items-center justify-center">
                                    <div className="font-bold text-base md:text-lg leading-loose tracking-widest text-red-950">
                                        {poem.map((line, i) => (
                                            <div key={i}>{line}</div>
                                        ))}
                                    </div>
                                </div>
                                
                                <div className="w-full flex justify-between items-end mt-10 px-1">
                                    <div className="flex flex-col gap-0.5">
                                        <span className="text-[8px] text-amber-800 font-bold opacity-50 uppercase tracking-tighter">Auth Date</span>
                                        <span className="text-[11px] font-bold">{currentDate}</span>
                                    </div>
                                    <div className="w-10 h-10 bg-red-700 p-1 rounded-sm flex flex-wrap items-center justify-center text-white text-[8px] font-black leading-none text-center shadow-md transform rotate-1">
                                        <div className="w-1/2">崇</div><div className="w-1/2">正</div>
                                        <div className="w-1/2">寶</div><div className="w-1/2">宮</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div className="mt-8 md:mt-12 flex flex-col items-center w-full max-w-[300px] gap-4">
                            <button onClick={() => {setPage('home'); setLotNumber('');}} className="w-full py-4 bg-gradient-to-r from-[#d97706] to-[#b45309] text-white rounded-full font-bold text-lg shadow-lg flex items-center justify-center gap-3 active:scale-95 transition-all">
                                <Icons.RefreshCw /> 再求一支靈籤
                            </button>
                            <button onClick={() => setPage('result')} className="text-amber-500 font-bold tracking-widest text-sm p-2 active:opacity-50">返回解籤</button>
                        </div>
                    </div>
                );
            }

            return null;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
